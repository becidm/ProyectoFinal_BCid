æ
cC:\Cursos\Codificaci√≥n Segura\ProyectoFinalSeguridadApps\WCFSeguridadApps\WsSecurityProject.svc.cs
	namespace 	
WCFSeguridadApps
 
{ 
public 

class 
WsSecurityProject "
:# $
ISecurityProject% 5
{ 
public 
Validate 
ValidateInputText )
() *
SecurityInput* 7
inputstring8 C
)C D
{ 	
Validate 
result 
= 
new !
Validate" *
(* +
)+ ,
;, -
try 
{ 
BusinessRules 
manager %
=& '
new( +
BusinessRules, 9
(9 :
): ;
;; <
result 
. 
Output 
= 
manager  '
.' (
ValidateInputText( 9
(9 :
inputstring: E
.E F
InputStringF Q
)Q R
;R S
} 
catch 
( 
	Exception 
ex 
)  
{ 
result 
. 
Output 
. 
Message %
=& '
ex( *
.* +
Message+ 2
;2 3
result 
. 
Output 
. 
IsMatch %
=& '
false( -
;- .
} 
return 
result 
; 
} 	
public"" 
CreditCardInf"" 
GetCreditCardNum"" -
(""- .
SecurityInput"". ;
	inputText""< E
)""E F
{## 	
CreditCardInf$$ 
cc$$ 
=$$ 
new$$ "
CreditCardInf$$# 0
($$0 1
)$$1 2
;$$2 3
try%% 
{&& 
BusinessRules'' 
manager'' %
=''& '
new''( +
BusinessRules'', 9
(''9 :
)'': ;
;''; <
cc(( 
.(( 

creditCard(( 
=(( 
manager((  '
.((' (
GetCreditCardInfo((( 9
(((9 :
	inputText((: C
.((C D
InputString((D O
)((O P
;((P Q
})) 
catch** 
(** 
	Exception** 
ex** 
)**  
{++ 
cc,, 
.,, 

creditCard,, 
.,, 
IsValid,, %
=,,& '
false,,( -
;,,- .
cc-- 
.-- 

creditCard-- 
.-- 
Message-- %
=--& '
ex--( *
.--* +
Message--+ 2
;--2 3
}.. 
return// 
cc// 
;// 
}00 	
public77 
Result77 #
ProcessCreditCardNumber77 -
(77- .
SanitizedInput77. <
input77= B
)77B C
{88 	
BusinessRules99 
manager99 !
=99" #
new99$ '
BusinessRules99( 5
(995 6
)996 7
;997 8
Result:: 
res:: 
=:: 
new:: 
Result:: #
(::# $
)::$ %
;::% &
try<< 
{== 
res>> 
.>> 
encodingData>>  
=>>! "
manager>># *
.>>* +
EncodingCreditCard>>+ =
(>>= >
input>>> C
.>>C D
Value>>D I
)>>I J
;>>J K
}?? 
catch@@ 
(@@ 
	Exception@@ 
ex@@ 
)@@  
{AA 
resCC 
.CC 
MessageCC 
=CC 
exCC  
.CC  !
MessageCC! (
;CC( )
}DD 
returnEE 
resEE 
;EE 
}FF 	
}GG 
}HH „
^C:\Cursos\Codificaci√≥n Segura\ProyectoFinalSeguridadApps\WCFSeguridadApps\ISecurityProject.cs
	namespace 	
WCFSeguridadApps
 
{ 
[ 
DataContract 
] 
public 

class 
SecurityInput 
{		 
[

 	

DataMember

	 
]

 
public 
string 
InputString !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
[ 
DataContract 
] 
public 

class 
SanitizedInput 
{ 
[ 	

DataMember	 
] 
public 
string 
Value 
{ 
get !
;! "
set# &
;& '
}( )
} 
[ 
DataContract 
] 
public 

class 
CreditCardInf 
{ 
[ 	

DataMember	 
] 
public 

CreditCard 

creditCard $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
[ 
DataContract 
] 
public 

class 
Result 
{ 
[ 	

DataMember	 
] 
public 
EncodingData 
encodingData (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
[ 	

DataMember	 
] 
public 
bool 
IsMatch 
{ 
get !
;! "
set# &
;& '
}( )
[   	

DataMember  	 
]   
public!! 
string!! 
Message!! 
{!! 
get!!  #
;!!# $
set!!% (
;!!( )
}!!* +
}"" 
[## 
DataContract## 
]## 
public$$ 

class$$ 
Validate$$ 
{%% 
[&& 	

DataMember&&	 
]&& 
public'' 
InputResult'' 
Output'' !
{''" #
get''$ '
;''' (
set'') ,
;'', -
}''. /
public)) 
Validate)) 
()) 
))) 
{** 	
Output++ 
=++ 
new++ 
InputResult++ $
(++$ %
)++% &
;++& '
},, 	
}-- 
[.. 
ServiceContract.. 
].. 
public// 

	interface// 
ISecurityProject// %
{00 
[11 	
OperationContract11	 
]11 
Validate22 
ValidateInputText22 "
(22" #
SecurityInput22# 0
inputstring221 <
)22< =
;22= >
[33 	
OperationContract33	 
]33 
CreditCardInf44 
GetCreditCardNum44 &
(44& '
SecurityInput44' 4
	inputText445 >
)44> ?
;44? @
[55 	
OperationContract55	 
]55 
Result66 #
ProcessCreditCardNumber66 &
(66& '
SanitizedInput66' 5
input666 ;
)66; <
;66< =
}88 
}99 ê
eC:\Cursos\Codificaci√≥n Segura\ProyectoFinalSeguridadApps\WCFSeguridadApps\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str +
)+ ,
], -
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str -
)- .
]. /
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *